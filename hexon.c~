# include <stdio.h>
# include <strings.h>
# include <stdlib.h>

//hexon
//prints hex values beneath text reads from files or from stdio
// Thomas Garside

void readFile(char*);
char * hexNums(int); 


int main(int argc, char** argv){
  // read list of files from argv if none exist read from stdin

  if (argc > 1){
    readFile(argv[1]);
  }
  else{
    printf("No files read");
  }
  
}

// process a single file 
void readFile(char* filename){
  FILE* file = fopen(filename, "r");
  char* line = NULL;
  size_t len = 0;
  ssize_t read;

  if (file == NULL)
    exit(EXIT_FAILURE);

  while((read = getline(&line, &len, file)) != -1){
    int linelen = strlen(line);
    char line1[linelen];
    char line2[linelen];

    for( int i=0; i<linelen; i++){
      char hexVal[2] = hexNums(line[i]);
      line1[i] = hexVal[1];
      line2[i] = hexVal[2];
    }
    printf(" %s", line);
    printf("|%s|",line1);
    printf("|%s|",line2); 
    
  }
  
}

// convert a char to its hex components 
char* hexNums(int charVal){
  char hexnums[2];
  int temp = charVal % 16;

  if (temp < 10){
    hexnums[0] = temp + 48; 
  }
  else {
    hexnums[0] = temp + 55;
  }

  temp = (charVal / 16) % 16;
  
  if (temp < 10){
    hexnums[1] = temp +	48;
  }
  else {
    hexnums[1] = temp +	55;
  }

  return hexnums; 

}
